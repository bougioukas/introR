<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.322">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>An Introduction to R - 9&nbsp; Data transformation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./visualization.html" rel="next">
<link href="./list.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.29/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="site_libs/dt-ext-scroller-1.13.4/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-scroller-1.13.4/js/dataTables.scroller.min.js"></script><link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction.html">Basics</a></li><li class="breadcrumb-item"><a href="./transformation.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data transformation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">An Introduction to R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/bougioukas/introR" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R and Rstudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calculations in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">R objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data structures in R: 1-Dimensional Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data structures in R: matrices and arrays</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data structures in R: lists and data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transformation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Visualization: ggplot2</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Special Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Animated and Interactive Plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">SQL queries within R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#importing-data" id="toc-importing-data" class="nav-link active" data-scroll-target="#importing-data"><span class="header-section-number">9.1</span> Importing data</a></li>
  <li><a href="#subsetting-variables" id="toc-subsetting-variables" class="nav-link" data-scroll-target="#subsetting-variables"><span class="header-section-number">9.2</span> Subsetting variables</a></li>
  <li><a href="#subsetting-observations" id="toc-subsetting-observations" class="nav-link" data-scroll-target="#subsetting-observations"><span class="header-section-number">9.3</span> Subsetting observations</a></li>
  <li><a href="#subsetting-variables-and-observations-by-indexing" id="toc-subsetting-variables-and-observations-by-indexing" class="nav-link" data-scroll-target="#subsetting-variables-and-observations-by-indexing"><span class="header-section-number">9.4</span> Subsetting variables and observations by indexing <code>[ ]</code></a></li>
  <li><a href="#reorder-rows-using-arrange-from-dplyr" id="toc-reorder-rows-using-arrange-from-dplyr" class="nav-link" data-scroll-target="#reorder-rows-using-arrange-from-dplyr"><span class="header-section-number">9.5</span> Reorder rows using <code>arrange()</code> from <code>dplyr</code></a></li>
  <li><a href="#create-new-variables-with-mutate" id="toc-create-new-variables-with-mutate" class="nav-link" data-scroll-target="#create-new-variables-with-mutate"><span class="header-section-number">9.6</span> Create new variables with <code>mutate()</code></a></li>
  <li><a href="#using-the-pipe-operator-in-a-sequence-of-functions" id="toc-using-the-pipe-operator-in-a-sequence-of-functions" class="nav-link" data-scroll-target="#using-the-pipe-operator-in-a-sequence-of-functions"><span class="header-section-number">9.7</span> Using the pipe operator %&gt;% in a sequence of functions</a></li>
  <li><a href="#more-examples-and-functions" id="toc-more-examples-and-functions" class="nav-link" data-scroll-target="#more-examples-and-functions"><span class="header-section-number">9.8</span> More examples and functions</a></li>
  <li><a href="#explore-for-outliers-in-the-dataset" id="toc-explore-for-outliers-in-the-dataset" class="nav-link" data-scroll-target="#explore-for-outliers-in-the-dataset"><span class="header-section-number">9.9</span> Explore for outliers in the dataset</a></li>
  <li>
<a href="#summarizing-numerical-variables" id="toc-summarizing-numerical-variables" class="nav-link" data-scroll-target="#summarizing-numerical-variables"><span class="header-section-number">9.10</span> Summarizing Numerical variables</a>
  <ul class="collapse">
<li><a href="#summary-measures-for-one-numerical-variable" id="toc-summary-measures-for-one-numerical-variable" class="nav-link" data-scroll-target="#summary-measures-for-one-numerical-variable">Summary measures for one numerical variable</a></li>
  <li><a href="#summary-measures-for-more-numerical-variables" id="toc-summary-measures-for-more-numerical-variables" class="nav-link" data-scroll-target="#summary-measures-for-more-numerical-variables">Summary measures for more numerical variables</a></li>
  <li><a href="#grouping-rows-by-a-categorical-variable-and-summarize" id="toc-grouping-rows-by-a-categorical-variable-and-summarize" class="nav-link" data-scroll-target="#grouping-rows-by-a-categorical-variable-and-summarize">Grouping rows by a categorical variable and <code>summarize()</code></a></li>
  <li><a href="#grouping-by-more-than-one-variable" id="toc-grouping-by-more-than-one-variable" class="nav-link" data-scroll-target="#grouping-by-more-than-one-variable">Grouping by more than one variable</a></li>
  <li><a href="#more-summary-measures" id="toc-more-summary-measures" class="nav-link" data-scroll-target="#more-summary-measures">More summary measures</a></li>
  </ul>
</li>
  <li>
<a href="#summarizing-categorical-variables" id="toc-summarizing-categorical-variables" class="nav-link" data-scroll-target="#summarizing-categorical-variables"><span class="header-section-number">9.11</span> Summarizing Categorical variables</a>
  <ul class="collapse">
<li><a href="#frequency-distribution-table" id="toc-frequency-distribution-table" class="nav-link" data-scroll-target="#frequency-distribution-table">Frequency distribution table</a></li>
  <li><a href="#frequency-distribution-table-with-total-percentages" id="toc-frequency-distribution-table-with-total-percentages" class="nav-link" data-scroll-target="#frequency-distribution-table-with-total-percentages">Frequency distribution table with total percentages</a></li>
  <li><a href="#frequency-distribution-table-with-percentages-inside-for-each-bmi-category" id="toc-frequency-distribution-table-with-percentages-inside-for-each-bmi-category" class="nav-link" data-scroll-target="#frequency-distribution-table-with-percentages-inside-for-each-bmi-category">Frequency distribution table with percentages inside for each bmi category</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction.html">Basics</a></li><li class="breadcrumb-item"><a href="./transformation.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data transformation</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-transformation" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data transformation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>When we have finished this chapter, we should be able to:</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning objectives
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Import the data from spreadsheets in R.</li>
<li>Select rows in a data frame according to filtering conditions.</li>
<li>Select columns in a data frame.</li>
<li>Direct the output of one dplyr function to the input of another function with the “pipe” operator <code>%&gt;%</code>.</li>
<li>Add new columns to a data frame that are functions of existing columns with <code>mutate()</code>.</li>
<li>Use <code>summarize()</code> to calculate summary statistics for multiple variables, and <code>group_by()</code> to split a data frame into groups of observations, apply summary statistics for each group, and then combine the results.</li>
</ul>
</div>
</div>
<p>&nbsp;</p>
<section id="importing-data" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="importing-data">
<span class="header-section-number">9.1</span> Importing data</h2>
<p>Up to this point we have used data objects created with functions. Most of the time however, we work with data stored elsewhere and there are many ways to import such data into an R session.</p>
<p>Data are stored in spreadsheets which are often saved in one of the following two formats:</p>
<ol type="1">
<li>A <em>Comma Separated Values</em> <code>.csv</code> file. We can think of a <code>.csv</code> file as a barebones spreadsheet where:</li>
</ol>
<ul>
<li>Each line in the file corresponds to one row of data/one observation.</li>
<li>Values for each line are separated with commas “,”. In other words, the values of different variables are separated by commas.</li>
<li>The first line is often, but not always, a <em>header</em> row indicating the names of the columns/variables.</li>
</ul>
<ol start="2" type="1">
<li>An Excel <code>.xlsx</code> spreadsheet file. This format is based on Microsoft’s proprietary Excel software and may include the use of bold and italic fonts, colored cells, different column widths, and formula macros.</li>
</ol>
<p>We will use the dataset named <code>arrhythmia</code> which is a <code>.csv</code> file.</p>
<div class="cell">
<div id="fig-arrhythmia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8a5d424b5f5d6f6d2d38" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8a5d424b5f5d6f6d2d38">{"x":{"filter":"none","vertical":false,"extensions":["Scroller"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452"],[75,56,54,55,75,13,40,49,44,50,62,45,54,30,44,47,47,46,73,57,28,45,36,57,40,44,34,31,56,51,53,58,50,52,69,44,50,35,62,45,43,40,30,34,40,75,69,30,41,34,75,28,39,24,52,72,38,42,46,32,1,35,36,27,48,44,54,26,45,64,37,37,31,46,35,34,45,37,56,71,37,57,79,51,63,75,19,40,68,73,52,64,63,62,25,55,33,37,52,36,51,39,19,27,36,63,46,57,17,50,71,43,33,9,29,39,74,28,24,58,69,50,72,71,37,25,58,61,53,46,56,48,39,46,41,40,47,47,35,51,35,1,49,31,34,36,18,34,39,17,48,32,36,34,27,45,45,60,59,46,42,42,54,24,40,25,68,19,73,40,44,50,32,56,55,54,64,27,66,56,63,18,44,57,65,61,47,62,22,66,49,60,65,36,44,27,21,46,13,58,70,64,50,35,33,46,53,62,42,47,11,18,63,53,49,30,17,66,50,77,47,42,56,83,42,67,37,43,36,49,72,80,22,57,46,45,43,36,56,38,43,62,46,49,72,60,48,52,44,46,15,58,46,59,66,68,53,45,48,44,33,35,39,38,34,35,58,50,43,50,72,48,61,63,61,64,32,58,48,31,41,49,57,35,73,65,33,35,57,50,60,45,40,55,44,33,59,7,12,51,59,63,74,67,31,14,37,53,62,40,41,80,69,70,64,57,0,52,55,37,3,26,59,54,38,48,58,67,64,59,59,65,42,37,19,47,31,33,39,42,54,44,48,72,36,32,20,81,34,62,64,53,48,26,45,47,47,56,40,54,62,40,47,57,38,46,43,59,64,30,68,46,48,72,15,70,67,54,67,8,66,57,36,47,35,75,78,53,44,70,66,36,51,16,59,61,45,30,47,71,55,9,66,7,62,21,76,25,58,66,57,64,41,53,67,30,27,65,50,27,58,63,29,51,7,36,35,58,64,8,11,47,11,70,20,39,32,35,37,49,37,37,65,41,29,45,20,53,37,36,32,78],[0,1,0,0,0,0,1,1,0,1,0,1,1,0,1,1,0,1,0,1,1,0,1,1,1,0,0,1,1,1,0,1,1,1,0,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,0,1,0,0,1,0,0,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,0,0,1,0,1,0,0,1,0,1,1,1,1,0,0,0,1,1,0,0,1,0,0,1,1,0,1,0,1,0,1,1,0,1,0,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,0,0,1,1,1,1,1,0,0,0,1,0,1,1,1,1,0,1,1,0,0,0,1,0,1,0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,0,1,0,0,1,0,1,0,0,0,1,1,1,1,0,0,1,0,0,1,1,0,0,0,0,1,0,0,1,0,1,0,0,1,0,1,0,1,0,1,1,1,0,1,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,0,0,0,0,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,1,0,0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,1,0,0,0,0,1,1,1,1,1,0,0,1,0,0,0,1,0,1,1,0,0,1,1,0,0,0,0,0,1,0,1,0,1,0,1,0,0,0,0,0,1,1,0,1,1,1,0,1,1,0,0,0,0,0,0,1,0,1,0,0,1,0,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,0,0,1,1,0,1,0,1,1,1,1,1,0,0,0,1,0,0,1,0,0,0,0,0,1,1,1,0,1,0,1,1,1,0,0,1,1,0,0,1,1],[190,165,172,175,190,169,160,162,168,167,170,165,172,170,160,150,171,158,165,166,160,169,153,165,153,169,170,160,164,160,175,163,160,155,176,160,172,164,163,175,157,160,160,165,160,156,160,158,159,159,156,156,172,163,165,160,160,168,165,160,110,160,158,162,155,155,160,160,150,156,155,182,161,163,158,165,177,171,165,156,156,177,150,165,160,159,165,162,161,158,155,155,163,165,168,185,150,157,155,160,156,155,157,170,160,175,165,153,170,184,162,176,163,132,172,160,172,159,162,170,154,164,170,170,159,162,186,185,155,163,165,165,157,177,155,172,168,162,162,160,170,780,166,150,175,168,175,155,160,160,156,173,172,167,161,169,162,160,161,153,170,160,170,176,165,162,168,156,160,160,178,168,163,168,156,160,160,155,167,162,156,175,179,175,155,170,163,170,165,156,166,160,180,172,173,155,166,168,133,155,160,160,159,160,168,162,178,176,157,176,124,180,174,169,160,160,156,160,170,165,165,178,173,160,165,171,168,172,170,170,171,173,163,164,165,173,176,149,170,165,160,155,177,166,165,155,157,153,160,165,170,175,170,160,160,164,165,170,178,170,165,160,160,170,150,155,160,174,163,160,160,158,171,160,154,156,157,150,160,168,175,170,175,165,165,175,160,155,175,163,158,170,178,173,160,160,160,130,165,170,165,164,170,176,160,175,175,171,170,176,180,160,160,165,167,170,608,174,170,170,105,180,161,164,170,170,166,168,156,155,165,171,188,175,165,160,165,165,160,172,170,157,162,165,171,158,186,165,165,178,173,156,160,170,169,175,175,170,150,160,157,170,163,170,172,178,165,160,170,181,146,165,182,154,163,160,163,160,160,120,168,165,185,169,165,162,152,156,170,178,160,176,165,160,174,156,158,160,175,165,160,120,155,127,165,156,150,160,148,160,172,160,170,160,165,167,167,172,163,160,160,167,162,186,119,171,160,160,160,130,138,166,140,167,178,164,164,155,175,168,176,160,160,154,166,175,157,160,190,166,155,160],[80,64,95,94,80,51,52,54,56,67,72,86,58,73,88,48,59,58,63,72,58,67,75,59,55,80,73,54,65,83,85,68,73,70,75,45,80,94,60,80,71,75,62,61,51,55,71,57,55,68,53,52,76,53,80,70,63,79,66,58,10,51,58,53,55,65,63,65,71,82,60,90,73,100,60,65,72,85,73,56,52,68,60,76,80,59,50,65,70,72,104,88,62,70,55,105,55,62,104,70,60,59,40,66,65,80,55,61,61,96,72,90,75,33,69,45,74,56,75,75,59,75,74,52,56,78,18,95,63,86,54,70,56,90,56,60,64,74,68,80,80,6,73,64,60,75,60,54,62,54,62,75,90,60,51,73,61,83,70,70,80,68,78,72,53,48,59,47,80,70,89,80,65,76,78,64,67,55,70,64,70,66,85,80,68,78,55,85,52,80,62,61,79,81,71,45,68,60,30,60,90,80,70,51,105,65,84,73,65,95,25,63,79,176,80,65,40,60,80,77,67,75,84,55,54,67,82,90,85,79,74,85,50,64,83,70,72,48,80,98,54,78,85,87,68,65,95,55,64,60,53,78,80,68,124,53,64,74,80,75,85,67,74,95,45,55,62,90,85,106,70,52,70,63,63,73,58,78,61,80,97,80,81,95,58,65,69,58,70,58,75,74,76,75,65,64,72,30,47,82,65,54,67,80,55,59,71,79,110,74,88,70,60,70,72,65,10,82,72,90,12,97,94,83,69,74,70,65,76,72,74,85,91,88,65,65,56,58,70,83,70,60,84,64,76,63,66,60,60,89,63,65,48,43,80,82,94,82,48,70,65,68,80,66,61,86,80,52,70,78,62,77,77,55,38,84,78,67,68,28,82,74,95,80,59,74,46,70,84,80,53,65,85,60,74,77,65,52,94,82,70,25,62,22,70,44,54,56,65,70,74,60,67,60,53,77,48,66,65,42,90,68,57,95,21,93,53,65,63,24,29,56,42,60,65,62,57,63,82,66,72,50,50,75,63,75,57,70,85,68,55,70],[91,81,138,100,88,100,77,78,84,89,102,77,78,91,77,75,82,70,91,82,83,90,71,75,82,109,94,95,90,96,85,71,75,78,82,69,103,85,80,94,80,79,92,84,86,73,75,73,78,80,81,83,103,92,88,77,79,90,91,83,80,78,76,82,81,80,82,71,73,87,76,101,93,90,87,88,94,94,90,78,83,92,93,100,83,163,96,114,170,137,84,82,79,72,97,87,102,85,84,78,79,91,98,86,72,97,82,78,97,94,82,78,79,87,93,75,106,96,88,90,74,85,90,71,75,77,87,95,74,99,89,83,78,100,80,87,79,102,80,85,81,85,95,82,97,92,102,86,80,85,85,111,89,63,70,92,75,93,83,84,91,81,113,92,81,74,78,80,82,95,106,95,100,90,88,71,78,77,87,79,85,91,92,98,68,84,92,110,108,153,73,81,87,87,95,73,95,100,96,97,76,62,86,71,99,68,90,146,86,80,90,93,91,111,89,79,77,73,92,98,78,87,98,84,82,90,85,71,84,85,77,93,74,89,89,103,85,88,81,84,96,90,98,78,93,80,85,67,74,69,105,95,87,108,99,79,86,82,91,93,80,84,90,81,90,78,98,81,90,85,79,61,90,79,83,84,78,86,72,87,91,102,80,82,104,85,83,81,94,84,91,99,101,132,79,103,97,131,91,90,121,78,84,97,94,96,91,80,97,92,90,90,123,105,85,77,83,92,85,96,69,88,84,107,91,74,89,109,80,83,92,100,113,105,99,84,74,76,87,87,96,88,80,85,90,74,95,86,74,95,74,73,104,92,105,97,101,83,84,98,81,93,84,102,94,91,100,92,94,98,146,84,77,82,84,76,106,70,87,118,86,82,96,89,93,82,97,86,188,93,72,107,81,76,83,147,82,110,108,82,93,95,80,185,73,78,71,86,85,76,93,87,96,86,78,87,80,98,75,78,82,94,83,94,140,87,55,133,83,77,123,79,88,80,88,79,77,87,88,94,88,74,85,88,81,91,81,80,100,108,93,79],[63,53,75,71,75,84,70,67,64,63,70,72,73,56,72,76,67,70,66,66,76,66,77,69,68,63,83,67,79,71,51,81,93,69,80,63,70,62,75,53,70,82,91,64,79,89,98,67,53,78,65,73,73,64,59,57,70,71,56,66,104,92,65,70,67,73,54,70,56,65,53,69,80,60,66,60,63,70,65,98,78,86,74,81,50,72,67,76,63,80,68,85,75,103,93,64,79,73,66,72,73,63,101,65,57,89,63,72,86,68,68,85,77,78,57,65,61,86,93,70,81,80,71,92,81,73,70,80,72,76,63,61,81,63,70,58,62,68,80,85,75,138,60,76,69,60,62,62,65,93,74,74,61,54,58,65,77,80,69,73,64,85,61,68,72,60,86,92,103,89,70,73,72,75,71,56,78,67,57,75,64,72,79,92,82,84,77,66,93,64,71,84,63,84,77,94,82,53,96,74,89,68,81,73,70,60,69,64,64,58,91,92,59,74,98,79,89,81,70,59,81,75,51,84,66,81,56,81,62,72,84,80,60,67,74,86,66,77,79,88,78,89,63,115,61,98,72,98,78,86,80,76,97,60,94,69,94,64,102,86,87,96,72,93,73,87,72,87,68,73,68,62,53,63,73,78,68,71,71,69,82,74,78,55,64,78,73,68,72,76,76,61,84,53,78,73,72,87,68,73,75,65,44,93,66,83,103,50,100,86,68,67,50,93,70,81,163,74,79,89,124,59,66,76,76,67,73,63,62,75,65,63,78,84,72,76,75,92,80,81,81,71,78,58,72,72,57,76,112,70,63,65,58,73,93,92,93,72,53,101,87,68,67,50,56,72,80,75,81,66,61,69,89,63,96,88,69,78,61,123,88,107,85,65,54,77,75,117,77,92,71,85,75,69,63,56,87,66,86,83,67,82,59,122,77,69,63,78,71,66,77,61,63,80,81,68,89,102,68,78,104,59,71,71,70,80,81,70,65,80,93,49,74,120,71,81,81,62,62,72,55,65,68,62,78,70,75,63,73,84,80,75]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>sex<\/th>\n      <th>height<\/th>\n      <th>weight<\/th>\n      <th>QRS<\/th>\n      <th>heart_rate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"deferRender":false,"dom":"t","columnDefs":[{"className":"dt-center","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"scrollY":452,"scroller":true,"scrollX":true,"pageLength":10,"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><figcaption class="figure-caption">Figure&nbsp;9.1: Table with raw data of arrhythmia data set.</figcaption></figure>
</div>
</div>
<p>The meta-data (data about the data) for this dataset are as following:</p>
<ol type="1">
<li>age: age (yrs)</li>
<li>sex: sex (0=male, 1=female)</li>
<li>height: height (cm)</li>
<li>weight: weight (kg)</li>
<li>QRS: mean duration of QRS (ms) <a href="images/QRS_normal.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/QRS_normal.png" width="88" height="68"></a>
</li>
<li>heart_rate: heart rate (beats/min)</li>
</ol>
<p>If the dataset is stored in our computer disc as a <code>.csv</code> file (<code>arrhythmia.csv</code>) we can read it with the <code>read_csv</code> function from <a href="https://readr.tidyverse.org">readr</a> package as following:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="va">arrhythmia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"arrhythmia.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">arrhythmia</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 452 × 6
     age   sex height weight   QRS heart_rate
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1    75     0    190     80    91         63
 2    56     1    165     64    81         53
 3    54     0    172     95   138         75
 4    55     0    175     94   100         71
 5    75     0    190     80    88         75
 6    13     0    169     51   100         84
 7    40     1    160     52    77         70
 8    49     1    162     54    78         67
 9    44     0    168     56    84         64
10    50     1    167     67    89         63
# ℹ 442 more rows</code></pre>
</div>
</div>
<p>This data frame contains 452 observations and 6 variables. However, when we call the name of the object (arrhythmia), we can see in the console the first 10 rows, and all the columns that fit on screen. Note that by default the first row of the <code>.csv</code> file was used as the column names of the data frame.</p>
<p>We might have noticed that the categorical variable <code>sex</code> is coded as 0 (for males) and 1 (for females), so it is recognized of <code>double</code> type. We can use the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function to encode a variable as a factor:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">arrhythmia</span><span class="op">$</span><span class="va">sex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">arrhythmia</span><span class="op">$</span><span class="va">sex</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the data again with the <code>glipmse()</code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">arrhythmia</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 452
Columns: 6
$ age        &lt;dbl&gt; 75, 56, 54, 55, 75, 13, 40, 49, 44, 50, 62, 45, 54, 30, 44,…
$ sex        &lt;fct&gt; male, female, male, male, male, male, female, female, male,…
$ height     &lt;dbl&gt; 190, 165, 172, 175, 190, 169, 160, 162, 168, 167, 170, 165,…
$ weight     &lt;dbl&gt; 80, 64, 95, 94, 80, 51, 52, 54, 56, 67, 72, 86, 58, 73, 88,…
$ QRS        &lt;dbl&gt; 91, 81, 138, 100, 88, 100, 77, 78, 84, 89, 102, 77, 78, 91,…
$ heart_rate &lt;dbl&gt; 63, 53, 75, 71, 75, 84, 70, 67, 64, 63, 70, 72, 73, 56, 72,…</code></pre>
</div>
</div>
<p>Now, the variable <code>sex</code> is a factor variable (<code>fct</code>) with two levels:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">arrhythmia</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "male"   "female"</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="subsetting-variables" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="subsetting-variables">
<span class="header-section-number">9.2</span> Subsetting variables</h2>
<p>We don’t necessarily need all the variables, and a good practice for large datasets with many variables is to select only the variables we are actually interested in. In this chapter we review the different ways of selecting variables.</p>
<p>Variable selection is not very useful with the <code>arrhythmia</code> data because we only have 6 variables, but we can still get the general idea.</p>
<p><strong>A. Select variables by name using <code>[ ]</code></strong></p>
<p>We can select only the <code>age</code>, <code>sex</code>, <code>QRS</code>, variables from the data frame:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span> , <span class="st">"QRS"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    age sex      QRS
  &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
1    75 male      91
2    56 female    81
3    54 male     138
4    55 male     100
5    75 male      88
6    13 male     100</code></pre>
</div>
</div>
<p><strong>B. Select or exclude variables by indexing <code>[ ]</code></strong> (not recommended)</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    age sex      QRS
  &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
1    75 male      91
2    56 female    81
3    54 male     138
4    55 male     100
5    75 male      88
6    13 male     100</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    age sex      QRS
  &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
1    75 male      91
2    56 female    81
3    54 male     138
4    55 male     100
5    75 male      88
6    13 male     100</code></pre>
</div>
</div>
<p><strong>C. Select variables using the <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> function</strong></p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">arrhythmia</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    age sex      QRS
  &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
1    75 male      91
2    56 female    81
3    54 male     138
4    55 male     100
5    75 male      88
6    13 male     100</code></pre>
</div>
</div>
<p>The <code>select</code> argument allows the selection by indexing the columns of interest in.</p>
<p><strong>D. Select variables using the <code>select()</code> function from <code>dplyr</code></strong></p>
<p>In <code>select()</code> function we pass the data frame first and then the variables separated by commas:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat5</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">QRS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
    age sex      QRS
  &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
1    75 male      91
2    56 female    81
3    54 male     138
4    55 male     100
5    75 male      88
6    13 male     100</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="subsetting-observations" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="subsetting-observations">
<span class="header-section-number">9.3</span> Subsetting observations</h2>
<p><strong>A. Select rows by indexing <code>[ ]</code></strong></p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat6</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span></span>
<span><span class="va">dat6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
     age sex    height weight   QRS heart_rate
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1    75 male      190     80    88         75
 2    13 male      169     51   100         84
 3    40 female    160     52    77         70
 4    49 female    162     54    78         67
 5    44 male      168     56    84         64
 6    50 female    167     67    89         63
 7    62 male      170     72   102         70
 8    45 female    165     86    77         72
 9    54 female    172     58    78         73
10    30 male      170     73    91         56
11    44 female    160     88    77         72</code></pre>
</div>
</div>
<p><strong>B. Select rows by conditions using <code>[ ]</code></strong></p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat7</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">arrhythmia</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">75</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">dat7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
    age sex    height weight   QRS heart_rate
  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    79 female    150     60    93         74
2    77 male      165     77    98         59
3    83 female    160     55    84         84
4    80 male      173     85    93         80
5    80 male      160     70    90         67
6    81 female    165     60    86         76
7    78 male      152     46    97         75
8    76 female    150     54    71         63
9    78 female    160     70    79         75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat8</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">arrhythmia</span><span class="op">$</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">75</span> <span class="op">&amp;</span> <span class="va">arrhythmia</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">dat8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
    age sex    height weight   QRS heart_rate
  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    79 female    150     60    93         74
2    83 female    160     55    84         84
3    81 female    165     60    86         76
4    76 female    150     54    71         63
5    78 female    160     70    79         75</code></pre>
</div>
</div>
<p><strong>C. Select rows by conditions using <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> function</strong></p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">75</span><span class="op">)</span></span>
<span><span class="va">dat9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
    age sex    height weight   QRS heart_rate
  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    79 female    150     60    93         74
2    77 male      165     77    98         59
3    83 female    160     55    84         84
4    80 male      173     85    93         80
5    80 male      160     70    90         67
6    81 female    165     60    86         76
7    78 male      152     46    97         75
8    76 female    150     54    71         63
9    78 female    160     70    79         75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">75</span> <span class="op">&amp;</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span></span>
<span><span class="va">dat10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
    age sex    height weight   QRS heart_rate
  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    79 female    150     60    93         74
2    83 female    160     55    84         84
3    81 female    165     60    86         76
4    76 female    150     54    71         63
5    78 female    160     70    79         75</code></pre>
</div>
</div>
<p><strong>D. Select rows using the <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> from <code>dplyr</code></strong></p>
<p>We pass the data frame first and then one or more conditions separated by a comma:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">75</span><span class="op">)</span></span>
<span><span class="va">dat11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
    age sex    height weight   QRS heart_rate
  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    79 female    150     60    93         74
2    77 male      165     77    98         59
3    83 female    160     55    84         84
4    80 male      173     85    93         80
5    80 male      160     70    90         67
6    81 female    165     60    86         76
7    78 male      152     46    97         75
8    76 female    150     54    71         63
9    78 female    160     70    79         75</code></pre>
</div>
</div>
<p>If we want to select only female patients with age &gt; 75:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">75</span>, <span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span></span>
<span><span class="va">dat12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
    age sex    height weight   QRS heart_rate
  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    79 female    150     60    93         74
2    83 female    160     55    84         84
3    81 female    165     60    86         76
4    76 female    150     54    71         63
5    78 female    160     70    79         75</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="subsetting-variables-and-observations-by-indexing" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="subsetting-variables-and-observations-by-indexing">
<span class="header-section-number">9.4</span> Subsetting variables and observations by indexing <code>[ ]</code>
</h2>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat13</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">15</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dat13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
     age sex      QRS
   &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
 1    75 male      88
 2    13 male     100
 3    40 female    77
 4    49 female    78
 5    44 male      84
 6    50 female    89
 7    62 male     102
 8    45 female    77
 9    54 female    78
10    30 male      91
11    44 female    77</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="reorder-rows-using-arrange-from-dplyr" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="reorder-rows-using-arrange-from-dplyr">
<span class="header-section-number">9.5</span> Reorder rows using <code>arrange()</code> from <code>dplyr</code>
</h2>
<p>We can also arrange a data frame based on one or more variables. The <code>arrange()</code> function works similarly to <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> except that instead of selecting rows, it changes their order. It takes a data frame and a set of column names (or more complicated expressions) to order by. For example, we can arrange the rows of the <code>arrhythmia</code> table by the magnitude of <code>QRS</code> (in ascending order which is the default):</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat14</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="va">QRS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat14</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
     age sex    height weight   QRS heart_rate
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1    35 female    160     53    55         81
 2    48 female    158     52    61         62
 3    64 female    160     80    62         68
 4    34 female    167     60    63         54
 5    52 female    153     55    67         98
 6    65 female    155     68    68         82
 7    46 female    162     65    68         60
 8    44 female    160     45    69         63
 9    46 female    165     60    69         86
10     3 male      105     12    69        124</code></pre>
</div>
</div>
<p>We can use <code>desc()</code> to re-arrange in descending order. For example:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat15</span> <span class="op">&lt;-</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">arrhythmia</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">QRS</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat15</span>, <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
     age sex    height weight   QRS heart_rate
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1    44 male      170     84   188         77
 2     7 female    127     22   185        122
 3    68 male      161     70   170         63
 4    75 female    159     59   163         72
 5    66 female    156     80   153         64
 6    61 female    156     77   147         56
 7    62 male      176     73   146         64
 8    68 female    146     62   146         61
 9     7 male      119     21   140         70
10    54 male      172     95   138         75</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="create-new-variables-with-mutate" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="create-new-variables-with-mutate">
<span class="header-section-number">9.6</span> Create new variables with <code>mutate()</code>
</h2>
<p>Suppose we want to calculate BMI for the participants from weight and height. We can use the following code to calculate the BMI (we divide the height with 100, because it was given in cm):</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mutate</span><span class="op">(</span><span class="va">arrhythmia</span>, bmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">/</span> <span class="op">(</span><span class="va">height</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">^</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 452 × 7
     age sex    height weight   QRS heart_rate   bmi
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1    75 male      190     80    91         63  22.2
 2    56 female    165     64    81         53  23.5
 3    54 male      172     95   138         75  32.1
 4    55 male      175     94   100         71  30.7
 5    75 male      190     80    88         75  22.2
 6    13 male      169     51   100         84  17.9
 7    40 female    160     52    77         70  20.3
 8    49 female    162     54    78         67  20.6
 9    44 male      168     56    84         64  19.8
10    50 female    167     67    89         63  24  
# ℹ 442 more rows</code></pre>
</div>
</div>
<p>which is equivalent to:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">arrhythmia</span> <span class="op">%&gt;%</span>   </span>
<span>     <span class="fu">mutate</span><span class="op">(</span>bmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">/</span> <span class="op">(</span><span class="va">height</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">^</span> <span class="fl">2</span>, digits<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
</section><section id="using-the-pipe-operator-in-a-sequence-of-functions" class="level2" data-number="9.7"><h2 data-number="9.7" class="anchored" data-anchor-id="using-the-pipe-operator-in-a-sequence-of-functions">
<span class="header-section-number">9.7</span> Using the pipe operator %&gt;% in a sequence of functions</h2>
<p>Let’s say that we want to find the BMI, and BMI categories only for the adults:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">arrhythmia_adults</span> <span class="op">&lt;-</span> <span class="va">arrhythmia</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu">mutate</span><span class="op">(</span>bmi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">/</span> <span class="op">(</span><span class="va">height</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span><span class="op">^</span> <span class="fl">2</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>               bmi_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">bmi</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">18.5</span>, <span class="fl">25.0</span>, <span class="fl">30.0</span>, <span class="cn">Inf</span><span class="op">)</span>, </span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"underweight"</span>,<span class="st">"normal"</span>,<span class="st">"overweight"</span>, <span class="st">"obese"</span><span class="op">)</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span></span>
<span><span class="va">arrhythmia_adults</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 428 × 8
     age sex    height weight   QRS heart_rate   bmi bmi_cat
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  
 1    75 male      190     80    91         63  22.2 normal 
 2    56 female    165     64    81         53  23.5 normal 
 3    54 male      172     95   138         75  32.1 obese  
 4    55 male      175     94   100         71  30.7 obese  
 5    75 male      190     80    88         75  22.2 normal 
 6    40 female    160     52    77         70  20.3 normal 
 7    49 female    162     54    78         67  20.6 normal 
 8    44 male      168     56    84         64  19.8 normal 
 9    50 female    167     67    89         63  24   normal 
10    62 male      170     72   102         70  24.9 normal 
# ℹ 418 more rows</code></pre>
</div>
</div>
<p>We would read this sequence as:</p>
<ol type="1">
<li>Take the dataset <code>arrythmia</code> <em>then</em>
</li>
<li>Use this output as the input to the <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> to select only the adults (age &gt;=18) <em>then</em>
</li>
<li>Use this output as the input to the <code>mutate()</code> to calculate <code>bmi</code> and <code>bmi_cat</code>.</li>
</ol>
<p>Can you imagine what is the function of <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> for?</p>
<p>&nbsp;</p>
</section><section id="more-examples-and-functions" class="level2" data-number="9.8"><h2 data-number="9.8" class="anchored" data-anchor-id="more-examples-and-functions">
<span class="header-section-number">9.8</span> More examples and functions</h2>
<p>Now, we want from the <code>arrhythmia_adults</code> to filter only the <code>overweight</code> or <code>obese</code> patients:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">overweight_obese</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">bmi_cat</span> <span class="op">==</span> <span class="st">"overweight"</span> <span class="op">|</span> <span class="va">bmi_cat</span> <span class="op">==</span> <span class="st">"obese"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, we used the logical operator <code>|</code>. The logical operators are:</p>
<ul>
<li>
<code>&amp;</code> (and)</li>
<li>
<code>|</code> (or)</li>
<li>
<code>!</code> (not)</li>
</ul>
<p>&nbsp;</p>
<p>Alternatively we can use the <code>%in%</code> operator. This operator helps us to easily create multiple <code>OR</code> arguments:</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">overweight_obese2</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">bmi_cat</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"overweight"</span>, <span class="st">"obese"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s say that we also want those overweight or obese people who have heart rate &gt; 85:</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">overweight_obese3</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">bmi_cat</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"overweight"</span>, <span class="st">"obese"</span><span class="op">)</span>, </span>
<span>                              <span class="va">heart_rate</span> <span class="op">&gt;=</span> <span class="fl">85</span><span class="op">)</span></span>
<span><span class="va">overweight_obese3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 8
     age sex    height weight   QRS heart_rate   bmi bmi_cat   
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     
 1    50 female    160     73    75         93  28.5 overweight
 2    69 female    160     71    75         98  27.7 overweight
 3    64 female    155     88    82         85  36.6 obese     
 4    62 female    165     70    72        103  25.7 overweight
 5    63 male      175     80    97         89  26.1 overweight
 6    43 male      176     90    78         85  29.1 overweight
 7    24 female    162     75    88         93  28.6 overweight
 8    51 female    160     80    85         85  31.2 obese     
 9    42 female    160     68    81         85  26.6 overweight
10    73 female    160     80    82        103  31.2 obese     
# ℹ 34 more rows</code></pre>
</div>
</div>
<p>Now, let’s rename variables for example <code>heart_rate</code> to <code>HR</code> and <code>sex</code> to <code>gender</code> in the subset <code>overweight_obese3</code>. Moreover, <code>select()</code> can be used with <code>everything()</code> to hoist a variable up to the front of the tibble:</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">overweight_obese3</span> <span class="op">%&gt;%</span> </span>
<span>          <span class="fu">rename</span><span class="op">(</span>HR <span class="op">=</span> <span class="va">heart_rate</span>, gender <span class="op">=</span> <span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>          <span class="fu">select</span><span class="op">(</span><span class="va">HR</span>, <span class="va">gender</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 8
      HR gender   age height weight   QRS   bmi bmi_cat   
   &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     
 1    93 female    50    160     73    75  28.5 overweight
 2    98 female    69    160     71    75  27.7 overweight
 3    85 female    64    155     88    82  36.6 obese     
 4   103 female    62    165     70    72  25.7 overweight
 5    89 male      63    175     80    97  26.1 overweight
 6    85 male      43    176     90    78  29.1 overweight
 7    93 female    24    162     75    88  28.6 overweight
 8    85 female    51    160     80    85  31.2 obese     
 9    85 female    42    160     68    81  26.6 overweight
10   103 female    73    160     80    82  31.2 obese     
# ℹ 34 more rows</code></pre>
</div>
</div>
</section><section id="explore-for-outliers-in-the-dataset" class="level2" data-number="9.9"><h2 data-number="9.9" class="anchored" data-anchor-id="explore-for-outliers-in-the-dataset">
<span class="header-section-number">9.9</span> Explore for outliers in the dataset</h2>
<p>Let’s take a look to the dataset <em>arrythmia_adults</em> with the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age            sex          height        weight           QRS       
 Min.   :18.00   male  :191   Min.   :146   Min.   : 18.0   Min.   : 55.0  
 1st Qu.:37.00   female:237   1st Qu.:160   1st Qu.: 60.0   1st Qu.: 80.0  
 Median :47.00                Median :165   Median : 70.0   Median : 86.0  
 Mean   :48.51                Mean   :165   Mean   : 70.1   Mean   : 88.4  
 3rd Qu.:59.00                3rd Qu.:170   3rd Qu.: 80.0   3rd Qu.: 94.0  
 Max.   :83.00                Max.   :190   Max.   :176.0   Max.   :188.0  
   heart_rate          bmi               bmi_cat   
 Min.   : 44.00   Min.   : 5.20   underweight: 11  
 1st Qu.: 65.00   1st Qu.:22.90   normal     :192  
 Median : 72.00   Median :25.40   overweight :167  
 Mean   : 73.33   Mean   :25.72   obese      : 58  
 3rd Qu.: 80.00   3rd Qu.:28.10                    
 Max.   :120.00   Max.   :61.60                    </code></pre>
</div>
</div>
<p>We can see that the minimum value in weight and bmi is 18 kg and 5.2, respectevely. However, these values can’t be right! We can also inspect the outliers in bmi variable using a simple boxplot <a href="#fig-boxplot_age" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>:</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">bmi</span>, main <span class="op">=</span> <span class="st">"Boxplot of age of adult patients"</span>, ylab <span class="op">=</span> <span class="st">"BMI"</span>, boxwex<span class="op">=</span><span class="fl">.3</span>, frame <span class="op">=</span> <span class="cn">FALSE</span>, col<span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxplot_age" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><a href="transformation_files/figure-html/fig-boxplot_age-1.png" class="lightbox" title="A Boxplot of age of adult patients." data-gallery="quarto-lightbox-gallery-2"><img src="transformation_files/figure-html/fig-boxplot_age-1.png" class="img-fluid figure-img" width="672"></a></p>
<figcaption class="figure-caption">Figure&nbsp;9.2: A Boxplot of age of adult patients.</figcaption></figure>
</div>
</div>
</div>
</section><section id="summarizing-numerical-variables" class="level2" data-number="9.10"><h2 data-number="9.10" class="anchored" data-anchor-id="summarizing-numerical-variables">
<span class="header-section-number">9.10</span> Summarizing Numerical variables</h2>
<section id="summary-measures-for-one-numerical-variable" class="level3"><h3 class="anchored" data-anchor-id="summary-measures-for-one-numerical-variable">Summary measures for one numerical variable</h3>
<p>The next common task when working with data frames is to compute <strong>summary measures</strong>. Summary measures are <strong>single numerical values</strong> that summarize a large number of values.<br>
Commonly known examples of summary measures for numerical data include the <strong>arithmetic mean</strong> (also called the average) and the <strong>median</strong> (the middle value). Other examples of summary measures that might not immediately come to mind include the <strong>sum</strong>, the smallest value also called the <strong>minimum</strong>, the largest value also called the <strong>maximum</strong>, the <strong>1st quartile</strong> and <strong>3rd quartile</strong>, the <strong>standard deviation</strong>, the <strong>skewness</strong>, and the <strong>kurtosis</strong>.</p>
<p>Summary functions in R take in many values and return a single value, as illustrated in Figure <a href="#fig-summary" class="quarto-xref">Figure&nbsp;<span>9.3</span></a>.</p>
<div id="fig-summary" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><a href="images/summary.png" class="lightbox" title="Diagram illustrating a summary function in R" data-gallery="quarto-lightbox-gallery-3"><img src="images/summary.png" class="img-fluid figure-img" style="width:75.0%"></a></p>
<figcaption class="figure-caption">Figure&nbsp;9.3: Diagram illustrating a summary function in R</figcaption></figure>
</div>
<p>Let’s calculate two summary measures for the <code>QRS</code> variable in the <code>arrhythmia_adults</code> data frame: the mean and standard deviation. To compute these summary measures, we need the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> <em>statistical functions</em> in R.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 88.3972</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.44674</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>na.rm</code> argument
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>na.rm</code> argument of <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> statistical functions takes a logical value (<code>TRUE</code>/ <code>FALSE</code>) indicating whether <code>NA</code> values should be stripped before the computation proceeds.</p>
</div>
</div>
<p>&nbsp;</p>
<p>Now, we’ll use the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> within the <strong><code>summarize()</code></strong> function from the <a href="https://dplyr.tidyverse.org">dplyr</a> package. Note we can also use the UK spelling of <code>summarise()</code>. The first argument should be a data frame with the raw data:</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_QRS</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            sd_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">summary_QRS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  mean_QRS sd_QRS
     &lt;dbl&gt;  &lt;dbl&gt;
1     88.4   14.4</code></pre>
</div>
</div>
<p>The results are saved in a new data frame <code>tibble</code> that has two columns/variables, the <code>mean_QRS</code> and the <code>sd_QRS</code>.</p>
<p>Other summary functions that can be used inside the <code>summarize()</code> verb to compute summary measures are:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>: the mean AKA the average</li>
<li>
<code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>: the standard deviation, which is a measure of spread</li>
<li>
<code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code> and <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>: the minimum and maximum values respectively</li>
<li>
<code><a href="https://rdrr.io/r/stats/IQR.html">IQR()</a></code>: Interquartile range</li>
<li>
<code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>: the sum</li>
<li>
<code>skewness()</code> : the skewness</li>
<li>
<code>kurtosis()</code> : the kurtosis</li>
<li>
<code>n()</code>: a count of the number of rows/observations in each group. This particular summary function will make more sense when <code>group_by()</code>.</li>
</ul></section><section id="summary-measures-for-more-numerical-variables" class="level3"><h3 class="anchored" data-anchor-id="summary-measures-for-more-numerical-variables">Summary measures for more numerical variables</h3>
<p>We can add more numerical variables:</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_QRS_age</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>                   <span class="fu">summarize</span><span class="op">(</span>mean_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                             sd_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                             mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                             sd_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                             <span class="op">)</span></span>
<span><span class="va">summary_QRS_age</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  mean_QRS sd_QRS mean_age sd_age
     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1     88.4   14.4     48.5   14.4</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>We can also calculate the mean for all numerical variables with the <code>summarize_if()</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_all_means</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise_if</span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        </span>
<span><span class="va">summary_all_means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
    age height weight   QRS heart_rate   bmi
  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1  48.5   165.   70.1  88.4       73.3  25.7</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="grouping-rows-by-a-categorical-variable-and-summarize" class="level3"><h3 class="anchored" data-anchor-id="grouping-rows-by-a-categorical-variable-and-summarize">Grouping rows by a categorical variable and <code>summarize()</code>
</h3>
<p>Say instead of a single mean of QRS for all the adults, we want the mean QRS for the participants in each bmi category, separately. In other words, we would like to compute the mean <code>QRS</code> split by <code>bmi_cat</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_QRS_bmi</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">bmi_cat</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            sd_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="co"># ungrouping variable is a good habit to prevent errors</span></span>
<span></span>
<span><span class="va">summary_QRS_bmi</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  bmi_cat     mean_QRS sd_QRS
  &lt;fct&gt;          &lt;dbl&gt;  &lt;dbl&gt;
1 underweight     81.6   10.1
2 normal          86.8   12.9
3 overweight      90.3   15.5
4 obese           89.5   16.3</code></pre>
</div>
</div>
<p>This code is identical to the previous code that created <code>summary_QRS</code>, but with an extra function <code>group_by()</code> added before the <code>summarize()</code>. Grouping the <code>arrhythmia_adults</code> dataset by <code>bmi_cat</code> and then applying the <code>summarize()</code> function yields a data frame that displays the mean and standard deviation QRS split by bmi categories.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>group_by()</code> function
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is important to note that the <code>group_by()</code> function doesn’t change data frames by itself. Rather it changes the grouping structure. It is only after we apply the <code>summarize()</code> function that the data frame changes.</p>
</div>
</div>
</section><section id="grouping-by-more-than-one-variable" class="level3"><h3 class="anchored" data-anchor-id="grouping-by-more-than-one-variable">Grouping by more than one variable</h3>
<p>We are not limited to grouping by one variable. Say we want to know the mean QRS of males and females in each of the four bmi categories:</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">QRS_bmi_sex</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">bmi_cat</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>mean_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            sd_QRS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">QRS_bmi_sex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  bmi_cat     sex    mean_QRS sd_QRS
  &lt;fct&gt;       &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 underweight male       86.5  11.0 
2 underweight female     78.9   9.17
3 normal      male       92.7  11.3 
4 normal      female     82.8  12.3 
5 overweight  male       96.2  16.0 
6 overweight  female     83.4  11.5 
7 obese       male       94.8  14.9 
8 obese       female     86.9  16.5 </code></pre>
</div>
</div>
</section><section id="more-summary-measures" class="level3"><h3 class="anchored" data-anchor-id="more-summary-measures">More summary measures</h3>
<p>Let’s look at some summary measures of the <code>QRS</code> variable by considering multiple statistical functions at once in the same <code>summarize()</code> code:</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">QRS_summary</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">QRS</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">QRS</span>, <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">QRS</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    skewness <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    kurtosis<span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">QRS</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">QRS_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 11
    min    q1 median    q3   max  mean    sd skewness kurtosis missing     n
  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;int&gt; &lt;int&gt;
1    55    80     86    94   188  88.4  14.4     2.46     13.9       0   428</code></pre>
</div>
</div>
<p>The distribution of the data can be represented by an histogram.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">QRS</span>, main <span class="op">=</span> <span class="st">"Histogram"</span>, xlab <span class="op">=</span> <span class="st">"QRS (ms)"</span>, ylab <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hist_QRS" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><a href="transformation_files/figure-html/fig-hist_QRS-1.png" class="lightbox" title="A Histogram of QRS of adult patients." data-gallery="quarto-lightbox-gallery-4"><img src="transformation_files/figure-html/fig-hist_QRS-1.png" class="img-fluid figure-img" width="672"></a></p>
<figcaption class="figure-caption">Figure&nbsp;9.4: A Histogram of QRS of adult patients.</figcaption></figure>
</div>
</div>
</div>
<p>As we can see the distribution of <code>QRS</code> variable is not symmetrical.</p>
<p>If we want the summary statistics for males and females separately we must use the <code>group_by()</code> function:</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">QRS_summary2</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">QRS</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">QRS</span>, <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">QRS</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    skewness <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    kurtosis<span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">QRS</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">QRS</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">QRS_summary2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 12
  sex      min    q1 median    q3   max  mean    sd skewness kurtosis missing
  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;int&gt;
1 male      71    87     92    99   188  94.4  14.1     2.93     17.1       0
2 female    55    77     82    87   163  83.5  12.8     2.98     17.0       0
# ℹ 1 more variable: n &lt;int&gt;</code></pre>
</div>
</div>
<div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">QRS</span><span class="op">[</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"male"</span><span class="op">]</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Histogram (males)"</span>, xlab <span class="op">=</span> <span class="st">"QRS (ms)"</span>, ylab <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">QRS</span><span class="op">[</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"female"</span><span class="op">]</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Histogram (females)"</span>, xlab <span class="op">=</span> <span class="st">"QRS (ms)"</span>, ylab <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hist_QRS_sex" class="cell quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div id="fig-hist_QRS_sex-1" class="quarto-figure quarto-figure-center anchored" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure"><p><a href="transformation_files/figure-html/fig-hist_QRS_sex-1.png" class="lightbox" title="Histogram of QRS of males." data-gallery="quarto-lightbox-gallery-5"><img src="transformation_files/figure-html/fig-hist_QRS_sex-1.png" class="img-fluid figure-img" width="672"></a></p>
<figcaption class="figure-caption">(a) Histogram of QRS of males.</figcaption></figure>
</div>
<div id="fig-hist_QRS_sex-2" class="quarto-figure quarto-figure-center anchored" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure"><p><a href="transformation_files/figure-html/fig-hist_QRS_sex-2.png" class="lightbox" title="Histogram of QRS of females." data-gallery="quarto-lightbox-gallery-6"><img src="transformation_files/figure-html/fig-hist_QRS_sex-2.png" class="img-fluid figure-img" width="672"></a></p>
<figcaption class="figure-caption">(b) Histogram of QRS of females.</figcaption></figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;9.5: Histogram of QRS of males and females patients.</figcaption><p></p>
</figure>
</div>
</div>
<p>Let’s see the <code>age</code> variable:</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">age_summary</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    skewness <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    kurtosis<span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 11
    min    q1 median    q3   max  mean    sd skewness kurtosis missing     n
  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;int&gt; &lt;int&gt;
1    18    37     47    59    83  48.5  14.4   0.0851     2.31       0   428</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">age</span>, main <span class="op">=</span> <span class="st">"Histogram"</span>, xlab <span class="op">=</span> <span class="st">"Age (years)"</span>, ylab <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hist_age" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><a href="transformation_files/figure-html/fig-hist_age-1.png" class="lightbox" title="A Histogram of age of adult patients." data-gallery="quarto-lightbox-gallery-7"><img src="transformation_files/figure-html/fig-hist_age-1.png" class="img-fluid figure-img" width="672"></a></p>
<figcaption class="figure-caption">Figure&nbsp;9.6: A Histogram of age of adult patients.</figcaption></figure>
</div>
</div>
</div>
<p>The <code>age</code> variable approximates a <strong>symmetrical distribution (bell-shaped)</strong>.</p>
</section></section><section id="summarizing-categorical-variables" class="level2" data-number="9.11"><h2 data-number="9.11" class="anchored" data-anchor-id="summarizing-categorical-variables">
<span class="header-section-number">9.11</span> Summarizing Categorical variables</h2>
<section id="frequency-distribution-table" class="level3"><h3 class="anchored" data-anchor-id="frequency-distribution-table">Frequency distribution table</h3>
<p>Summary measures for categorical data include <strong>frequencies</strong> and <strong>percentages</strong>. If we have two categorical variables, we might be interested in a 2-dimensional frequency distribution table. Say we want to know the number of males and females in each of the four bmi catecories. We can create a frequency distribution table with <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function for the variables <code>bmi_cat</code> and <code>sex</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">bmi_cat</span>, <span class="va">arrhythmia_adults</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
              male female
  underweight    4      7
  normal        77    115
  overweight    91     76
  obese         19     39</code></pre>
</div>
</div>
<p>We can also create a frequency distribution table using the functions <code>count()</code> from the <a href="https://dplyr.tidyverse.org">dplyr</a> package:</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb2</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span></span>
<span>             <span class="fu">count</span><span class="op">(</span><span class="va">bmi_cat</span>, <span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  bmi_cat     sex        n
  &lt;fct&gt;       &lt;fct&gt;  &lt;int&gt;
1 underweight male       4
2 underweight female     7
3 normal      male      77
4 normal      female   115
5 overweight  male      91
6 overweight  female    76
7 obese       male      19
8 obese       female    39</code></pre>
</div>
</div>
</section><section id="frequency-distribution-table-with-total-percentages" class="level3"><h3 class="anchored" data-anchor-id="frequency-distribution-table-with-total-percentages">Frequency distribution table with total percentages</h3>
<p>We can also create a summary statistics using the functions <code>count()</code> and <code>mutate()</code> from the <a href="https://dplyr.tidyverse.org">dplyr</a> package to find the <strong>total</strong> percentages:</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb3</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span></span>
<span>             <span class="fu">count</span><span class="op">(</span><span class="va">bmi_cat</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>             <span class="fu">mutate</span><span class="op">(</span>percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  bmi_cat     sex        n percentage
  &lt;fct&gt;       &lt;fct&gt;  &lt;int&gt;      &lt;dbl&gt;
1 underweight male       4       0.93
2 underweight female     7       1.64
3 normal      male      77      18.0 
4 normal      female   115      26.9 
5 overweight  male      91      21.3 
6 overweight  female    76      17.8 
7 obese       male      19       4.44
8 obese       female    39       9.11</code></pre>
</div>
</div>
<p>In the above table we can see the frequency for each category and the total percentage (the frequency is divided by the total number of observations, here 428). For example, the percentage of underweight males is 0.93%, (4/428)*100.</p>
</section><section id="frequency-distribution-table-with-percentages-inside-for-each-bmi-category" class="level3"><h3 class="anchored" data-anchor-id="frequency-distribution-table-with-percentages-inside-for-each-bmi-category">Frequency distribution table with percentages inside for each bmi category</h3>
<p>However, we may want to calculate the percentage inside for each category. For example, the percentage of males (n = 4) in the underweight category (n = 11) is 36.4%, (4/11)*100. We will use the functions <code>group_by()</code>, <code>summarize()</code> and <code>mutate()</code> from the <code>dplyr</code> package:</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb4</span> <span class="op">&lt;-</span> <span class="va">arrhythmia_adults</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">bmi_cat</span>, <span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>n<span class="op">=</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  bmi_cat     sex        n percentage
  &lt;fct&gt;       &lt;fct&gt;  &lt;int&gt;      &lt;dbl&gt;
1 underweight male       4       36.4
2 underweight female     7       63.6
3 normal      male      77       40.1
4 normal      female   115       59.9
5 overweight  male      91       54.5
6 overweight  female    76       45.5
7 obese       male      19       32.8
8 obese       female    39       67.2</code></pre>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./list.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data structures in R: lists and data frames</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./visualization.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Visualization: ggplot2</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2022, Konstantinos I. Bougioukas</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"openEffect":"zoom","loop":true,"closeEffect":"zoom","selector":".lightbox","descPosition":"bottom"});</script>


</body></html>